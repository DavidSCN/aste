<?xml version="1.0"?>

<precice-configuration>

  <log-filter target="debug" component="" switch="off" />
  <log-filter target="debug" component="precice::mapping" switch="on" />
  <!-- <log-filter target="debug" component="precice::impl::SolverInterfaceImpl" switch="on" /> -->

  <!-- <log-filter target="debug" component="precice::geometry" switch="on" /> -->
  <!-- <log-filter target="debug" component="precice::mesh" switch="on" /> -->
  <!-- <log-filter target="debug" component="precice::geometry::BroadcastFilterDecomposition" switch="on" /> -->
  <!-- <log-filter target="debug" component="precice::impl::SolverInterfaceImpl" switch="on" /> -->
  <log-filter target="info"  component="" switch="on"/>

  
  <log-output column-separator=" | " log-time-stamp="no" 
              log-time-stamp-human-readable="yes" log-machine-name="no" 
              log-message-type="no" log-trace="yes" />
  
  <solver-interface dimensions="2">
    
    <!-- Data fields that are exchanged between the solvers -->
    <data:scalar name="Data" />

    <!-- A common mesh that uses these data fields -->
    <mesh name="MeshA" flip-normals="no">
      <use-data name="Data" />
    </mesh>

    <mesh name="MeshB" flip-normals="no">
      <use-data name="Data" />
    </mesh>

    
    <m2n:sockets from="A" to="B" network="lo" exchange-directory="."  distribution-type="gather-scatter" />

    <participant name="A">
      <use-mesh name="MeshA" provide="yes" />
      <use-mesh name="MeshB" provide="no" from="B" />
      <write-data name="Data" mesh="MeshA" />
      <!-- <mapping:nearest-neighbor constraint="conservative" direction="write" from="MeshA" to="MeshB" /> -->
      <mapping:petrbf-gaussian shape-parameter="2" solver-rtol="1e-9" constraint="conservative" direction="write" from="MeshA" to="MeshB" x-dead="false" y-dead="true" z-dead="false" />
      <!-- <mapping:rbf-gaussian shape-parameter="10" constraint="conservative" direction="write" from="MeshA" to="MeshB" x-dead="false" y-dead="true" z-dead="false" /> -->
      
      <master:mpi-single />
    </participant>
    
    <participant name="B">
      <use-mesh name="MeshA" provide="no" from="A" />
      <use-mesh name="MeshB" provide="yes" />
      <read-data name="Data" mesh="MeshB" />
      <!-- <mapping:nearest-neighbor constraint="consistent" direction="read" from="MeshA" to="MeshB" /> -->
      <!-- <mapping:rbf-gaussian shape-parameter="10" constraint="consistent" direction="read" from="MeshA" to="MeshB" x-dead="false" y-dead="true" z-dead="false" /> -->

      <!-- <mapping:petrbf-gaussian shape-parameter="10" solver-rtol="1e-9" constraint="consistent" direction="read" from="MeshA" to="MeshB" x-dead="false" y-dead="true" z-dead="false" /> -->

      <master:mpi-single />
    </participant>

    
    <coupling-scheme:serial-explicit>
      <participants first="A" second="B" />
      <max-time value="1.0" />
      <timestep-length value="1" />
      <!-- <exchange data="Data" mesh="MeshA" from="A" to="B" /> -->
      <exchange data="Data" mesh="MeshB" from="A" to="B" />
    </coupling-scheme:serial-explicit>
    
  </solver-interface>
  
</precice-configuration>
